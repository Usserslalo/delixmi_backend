<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Delixmi - Estado de Verificaci√≥n</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="status-container">
    <!-- Header -->
    <div class="header">
      <div class="logo">
        <span class="logo-icon">üçΩÔ∏è</span>
        <span class="logo-text">Delixmi</span>
      </div>
    </div>
    
    <!-- Main Content -->
    <div class="main-content">
      <div class="status-card">
        <!-- Status Icon -->
        <div class="status-icon" id="statusIcon">
          <div class="icon-circle">
            <span class="icon" id="icon">‚è≥</span>
          </div>
        </div>
        
        <!-- Status Title -->
        <h1 class="status-title" id="statusTitle">Cargando...</h1>
        
        <!-- Status Message -->
        <div class="status-message" id="statusMessage">
          <p>Procesando tu solicitud...</p>
        </div>
        
        <!-- Action Buttons -->
        <div class="action-buttons" id="actionButtons">
          <!-- Los botones se generar√°n din√°micamente -->
        </div>
        
        <!-- Additional Info -->
        <div class="additional-info" id="additionalInfo">
          <!-- Informaci√≥n adicional se mostrar√° seg√∫n el estado -->
        </div>
      </div>
    </div>
    
    <!-- Footer -->
    <div class="footer">
      <p class="footer-text">
        ¬© 2024 Delixmi. Todos los derechos reservados.
      </p>
      <div class="footer-links">
        <a href="/" class="footer-link">Inicio</a>
        <a href="/api/auth/login" class="footer-link">Iniciar Sesi√≥n</a>
        <a href="/api/auth/register" class="footer-link">Registrarse</a>
      </div>
    </div>
  </div>
  
  <script>
    // Configuraci√≥n de estados
    const statusConfig = {
      success: {
        icon: '‚úÖ',
        iconClass: 'success',
        title: '¬°√âxito!',
        message: 'Tu solicitud se ha procesado correctamente.',
        buttons: [
          { text: 'Iniciar Sesi√≥n', href: '/api/auth/login', primary: true },
          { text: 'Ir al Inicio', href: '/', primary: false }
        ],
        additionalInfo: 'Ya puedes usar todas las funcionalidades de tu cuenta.'
      },
      error: {
        icon: '‚ùå',
        iconClass: 'error',
        title: 'Error',
        message: 'Ha ocurrido un problema al procesar tu solicitud.',
        buttons: [
          { text: 'Intentar de Nuevo', href: '/api/auth/resend-verification', primary: true },
          { text: 'Ir al Inicio', href: '/', primary: false }
        ],
        additionalInfo: 'Si el problema persiste, contacta con nuestro soporte.'
      },
      expired: {
        icon: '‚è∞',
        iconClass: 'warning',
        title: 'Enlace Expirado',
        message: 'El enlace de verificaci√≥n ha expirado.',
        buttons: [
          { text: 'Solicitar Nuevo Enlace', href: '/api/auth/resend-verification', primary: true },
          { text: 'Ir al Inicio', href: '/', primary: false }
        ],
        additionalInfo: 'Los enlaces de verificaci√≥n expiran por seguridad despu√©s de 1 hora.'
      },
      already_verified: {
        icon: '‚ÑπÔ∏è',
        iconClass: 'info',
        title: 'Ya Verificado',
        message: 'Tu cuenta ya est√° verificada.',
        buttons: [
          { text: 'Iniciar Sesi√≥n', href: '/api/auth/login', primary: true },
          { text: 'Ir al Inicio', href: '/', primary: false }
        ],
        additionalInfo: 'Puedes iniciar sesi√≥n normalmente con tus credenciales.'
      },
      loading: {
        icon: '‚è≥',
        iconClass: 'loading',
        title: 'Cargando...',
        message: 'Procesando tu solicitud...',
        buttons: [],
        additionalInfo: 'Por favor espera un momento.'
      }
    };
    
    // Funci√≥n para obtener par√°metros de la URL
    function getUrlParams() {
      const params = new URLSearchParams(window.location.search);
      return {
        status: params.get('status') || 'loading',
        title: params.get('title') || '',
        message: params.get('message') || '',
        actionUrl: params.get('actionUrl') || '',
        actionText: params.get('actionText') || ''
      };
    }
    
    // Funci√≥n para actualizar el contenido de la p√°gina
    function updatePageContent(params) {
      const { status, title, message, actionUrl, actionText } = params;
      
      // Obtener configuraci√≥n del estado
      let config = statusConfig[status] || statusConfig.error;
      
      // Si se proporcionan t√≠tulo y mensaje personalizados, usarlos
      if (title) config.title = title;
      if (message) config.message = message;
      
      // Actualizar icono
      const statusIcon = document.getElementById('statusIcon');
      const icon = document.getElementById('icon');
      statusIcon.className = `status-icon ${config.iconClass}`;
      icon.textContent = config.icon;
      
      // Actualizar t√≠tulo
      document.getElementById('statusTitle').textContent = config.title;
      
      // Actualizar mensaje
      document.getElementById('statusMessage').innerHTML = `<p>${config.message}</p>`;
      
      // Actualizar botones
      updateActionButtons(config, actionUrl, actionText);
      
      // Actualizar informaci√≥n adicional
      document.getElementById('additionalInfo').innerHTML = `<p>${config.additionalInfo}</p>`;
      
      // Actualizar t√≠tulo de la p√°gina
      document.title = `${config.title} - Delixmi`;
    }
    
    // Funci√≥n para actualizar los botones de acci√≥n
    function updateActionButtons(config, customActionUrl, customActionText) {
      const buttonsContainer = document.getElementById('actionButtons');
      buttonsContainer.innerHTML = '';
      
      // Si hay una acci√≥n personalizada, agregarla
      if (customActionUrl && customActionText) {
        const customButton = createButton(customActionText, customActionUrl, true);
        buttonsContainer.appendChild(customButton);
      }
      
      // Agregar botones de configuraci√≥n
      config.buttons.forEach(buttonConfig => {
        const button = createButton(buttonConfig.text, buttonConfig.href, buttonConfig.primary);
        buttonsContainer.appendChild(button);
      });
    }
    
    // Funci√≥n para crear un bot√≥n
    function createButton(text, href, primary = false) {
      const button = document.createElement('a');
      button.href = href;
      button.className = `action-button ${primary ? 'primary' : 'secondary'}`;
      button.textContent = text;
      return button;
    }
    
    // Funci√≥n para mostrar animaci√≥n de carga
    function showLoadingAnimation() {
      const icon = document.getElementById('icon');
      let dots = 0;
      const interval = setInterval(() => {
        dots = (dots + 1) % 4;
        icon.textContent = '‚è≥' + '.'.repeat(dots);
      }, 500);
      
      return interval;
    }
    
    // Funci√≥n principal de inicializaci√≥n
    function init() {
      const params = getUrlParams();
      
      // Mostrar animaci√≥n de carga si es necesario
      let loadingInterval = null;
      if (params.status === 'loading') {
        loadingInterval = showLoadingAnimation();
      }
      
      // Simular un peque√±o delay para mejor UX
      setTimeout(() => {
        if (loadingInterval) {
          clearInterval(loadingInterval);
        }
        updatePageContent(params);
      }, 1000);
    }
    
    // Inicializar cuando el DOM est√© listo
    document.addEventListener('DOMContentLoaded', init);
    
    // Manejar errores de JavaScript
    window.addEventListener('error', (event) => {
      console.error('Error en la p√°gina de estado:', event.error);
      updatePageContent({
        status: 'error',
        title: 'Error de P√°gina',
        message: 'Ha ocurrido un error inesperado. Por favor, intenta de nuevo.',
        actionUrl: '/',
        actionText: 'Ir al Inicio'
      });
    });
  </script>
</body>
</html>
