<!DOCTYPE html>
<html>

<head>
    <title>Socket.IO Test Client</title>
</head>

<body>
    <h1>Cliente de Prueba de Socket.IO</h1>
    <p>Abre la consola del navegador (presiona F12) para ver los mensajes.</p>

    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script>
        console.log("Intentando conectar como Repartidor...");
        const socket = io("ws://localhost:3000");

        socket.on("connect", () => {
            console.log("¡CONECTADO!", socket.id);
            document.body.style.backgroundColor = 'lightgreen';

            // Unirse al canal de repartidores
            const driverId = 9; // ID de Miguel
            console.log(`Uniendo al repartidor ${driverId} al canal...`);
            socket.emit('join_drivers_channel', { driverId: driverId });
        });

        socket.on('joined_drivers_channel', (data) => {
            console.log('Unido exitosamente al canal de repartidores:', data);
        });

        // ¡Escuchando nuevos pedidos disponibles!
        socket.on('new_order_available', (data) => {
            console.log('--- ¡NUEVO PEDIDO DISPONIBLE! ---');
            console.log(data);
            alert(`¡Nuevo pedido #${data.orderId} disponible para recoger!`);
        });
    </script>
</body>

</html>