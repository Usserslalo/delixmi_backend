<!DOCTYPE html>
<html>

<head>
    <title>Socket.IO Test Client</title>
</head>

<body>
    <h1>Cliente de Prueba de Socket.IO</h1>
    <p>Abre la consola del navegador (presiona F12) para ver los mensajes.</p>

    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script>
        console.log("Intentando conectar a ws://localhost:3000...");
        const socket = io("ws://localhost:3000");

        socket.on("connect", () => {
            console.log("¡CONECTADO EXITOSAMENTE!", socket.id);
            document.body.style.backgroundColor = 'lightblue';

            // Unirse a la sala personal del cliente "Sofía" (userId: 10)
            const userIdToJoin = 10;
            console.log(`Intentando unirse a la sala para el usuario ${userIdToJoin}...`);
            socket.emit('join_user_room', { userId: userIdToJoin });
        });

        // Escuchando la actualización del estado del pedido
        socket.on('order_status_update', (data) => {
            console.log('--- ¡ACTUALIZACIÓN DE PEDIDO! ---');
            console.log(data);
            alert(`¡Tu pedido ha sido actualizado a: ${data.status}!`);
        });

        socket.on("connect_error", (err) => {
            console.error("ERROR DE CONEXIÓN:", err.message);
            document.body.style.backgroundColor = 'lightcoral';
        });
    </script>
</body>

</html>